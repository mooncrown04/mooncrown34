<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">  <!-- SayfanÄ±n karakter kodlamasÄ± TÃ¼rkÃ§e uyumlu UTF-8 olarak ayarlanÄ±yor -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Mobil cihazlarda uyumlu gÃ¶rÃ¼ntÃ¼lenmesi iÃ§in viewport ayarÄ± -->
    <link href="https://vjs.zencdn.net/7.17.0/video-js.css" rel="stylesheet" />
	
	<title>IPTV Player</title> <!-- Sayfa baÅŸlÄ±ÄŸÄ± belirleniyor -->
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }  /* Genel sayfa stil ayarlarÄ± */
     /*   h2 { background-color: #333; color: white; padding: 10px; cursor: pointer; } */  /* Kanal baÅŸlÄ±klarÄ±nÄ±n tasarÄ±mÄ± */
        .channel { border: 1px solid #ccc; padding: 10px; margin: 10px; display: inline-block; width: 200px; cursor: pointer; } /* Kanal kutularÄ±nÄ±n stil ayarlarÄ± */
        img { width: 100%; height: auto; cursor: pointer; } /* ğŸ“Œ Logolar tÄ±klanabilir oldu */
       .fav-btn { padding: 5px; cursor: pointer; background: #FFD700; color: black; border: none; border-radius: 5px; margin-top: 5px; } /* ğŸ“Œ Favori butonu tasarÄ±mÄ± */
        #filter { margin: 20px; padding: 10px; width: 50%; } /* ğŸ“Œ Arama Ã§ubuÄŸu geniÅŸliÄŸi */
        .category-container,.favorite-container,.recent-container { display: none; } /* ğŸ“Œ Kategoriler, favoriler ve izlenenler baÅŸlangÄ±Ã§ta gizleniyor */

	#player-info {
    position: absolute;
    top: 10px;  /* OynatÄ±cÄ±nÄ±n Ã¼stÃ¼nden uzaklÄ±k */
    left: 10px; /* OynatÄ±cÄ±nÄ±n solundan uzaklÄ±k */
	background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px;
    display: flex;
    align-items: center;
    z-index: 1000; /* Video oynatÄ±cÄ±nÄ±n Ã¼zerinde kalmasÄ±nÄ± saÄŸlar */
     width: auto; /* Ä°Ã§eriÄŸe gÃ¶re geniÅŸlik */
    height: auto; /* Ä°Ã§eriÄŸe gÃ¶re yÃ¼kseklik */
}
	
/* Genel stiller (daha Ã¶nce verdiÄŸimiz gibi) */
#player-container {
    position: relative;
    display: none; /* BaÅŸlangÄ±Ã§ta gizli */
    margin-top: 20px;
    width: 80%; /* OynatÄ±cÄ±nÄ±n varsayÄ±lan geniÅŸliÄŸi */
    height: 500px; /* OynatÄ±cÄ±nÄ±n varsayÄ±lan yÃ¼ksekliÄŸi */
}

#player-logo-container {
    position: absolute;
    top: 10px;
    left: 10px;
    background-color: rgba(0, 0, 0, 0.7);
    padding: 5px;
    z-index: 1000;
    max-width: 100px;
    max-height: 50px;
}

#player-logo {
    max-height: 100%;
    max-width: 100%;
    display: block;
}

#player-title-container {
    position: absolute;
    bottom: 10px;
    left: 10px;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 5px;
    z-index: 1000;
}

#player-title {
    font-size: 1.2em;
}

.my-video-player {
    width: 100%;
    height: 100%;
}


	
/* Tam ekran stilleri */
#player-container:-webkit-full-screen,
#player-container:-moz-full-screen,
#player-container:-ms-fullscreen,
#player-container:-o-full-screen,
#player-container:full-screen {
    width: 100%; /* Tam ekranda geniÅŸlik */
    height: 100%; /* Tam ekranda yÃ¼kseklik */
    position: fixed; /* Tam ekran pozisyonu */
    top: 0;
    left: 0;
    z-index: 9999; /* En Ã¼stte gÃ¶ster */
}

#player-container:-webkit-full-screen .my-video-player,
#player-container:-moz-full-screen .my-video-player,
#player-container:-ms-fullscreen .my-video-player,
#player-container:-o-full-screen .my-video-player,
#player-container:full-screen .my-video-player {
    width: 100%;
    height: 100%;
}

#player-container:-webkit-full-screen #player-logo-container,
#player-container:-moz-full-screen #player-logo-container,
#player-container:-ms-fullscreen #player-logo-container,
#player-container:-o-full-screen #player-logo-container,
#player-container:full-screen #player-logo-container,
#player-container:-webkit-full-screen #player-title-container,
#player-container:-moz-full-screen #player-title-container,
#player-container:-ms-fullscreen #player-title-container,
#player-container:-o-full-screen #player-title-container,
#player-container:full-screen #player-title-container {
    display: none; /* Tam ekranda gizle */
}
	

	
		#error-message {
    display: none;
    text-align: center; /* Metni ortala */
    margin-top: 10px;    /* OynatÄ±cÄ±dan biraz uzaklaÅŸtÄ±r */
    padding: 10px;      /* Ä°Ã§ boÅŸluk ekle */
    background-color: #f8d7da; /* AÃ§Ä±k kÄ±rmÄ±zÄ± arka plan */
    color: #721c24;       /* Koyu kÄ±rmÄ±zÄ± metin rengi */
    border: 1px solid #f5c6cb; /* KenarlÄ±k rengi */
    border-radius: 5px;   /* KÃ¶ÅŸeleri yuvarla */
}


/*  kutularÄ±n css*/	
#m3u-boxes {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    margin-bottom: 20px;
}


   .box {
            width: 90px;
            height: 50px;
            border: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background-color: #f0f0f0;
            font-weight: bold;
            border-radius: 5px;
            transition: 0.3s;
        }

.box span {
    white-space: nowrap; /* Metni tek satÄ±rda tut */
    position: absolute;
    animation: marquee 5s linear infinite; /* SÃ¼rekli kayan yazÄ± */
}
.active-box {
        background-color: yellow; /* Kutunun rengi deÄŸiÅŸsin */
        border: 2px solid red; /* SeÃ§ildiÄŸini belli eden kenarlÄ±k */

@keyframes marquee {
    from { transform: translateX(100%); }
    to { transform: translateX(-100%); }
}
#error-box {
    display: none;
    background-color: #f8d7da; /* AÃ§Ä±k kÄ±rmÄ±zÄ± arka plan */
    color: #721c24; /* Koyu kÄ±rmÄ±zÄ± metin */
    padding: 10px;
    border: 2px solid #f5c6cb;
    border-radius: 10px;
    margin-top: 15px;
    text-align: center;
    width: 300px;
    position: relative;
    margin-left: auto;
    margin-right: auto;
}

#error-image {
    width: 50px;
    height: 50px;
    margin-bottom: 10px;
}

#search-results {
    width: 50%;
    margin: 10px auto;
    padding: 10px;
    border: 1px solid #ddd;
    background-color: #f9f9f9;
    display: none; /* BaÅŸlangÄ±Ã§ta gizli olacak */
}/*
.favorite-container {
	background-color: red;
    border: 2px solid #333;
    padding: 10px;
    border-radius: 5px;
    transition: background-color 0.5s ease, border-color 0.5s ease;  GeÃ§iÅŸ efekti ekleyelim 
}*/


/*
.active-fav { background-color: yellow !important; AÃ§Ä±ldÄ±ÄŸÄ±nda sarÄ± arka plan */ 
 /*   border: 2px solid red !important; KenarlÄ±k deÄŸiÅŸimi */
}
h2 {
    background-color: #333;
    color: white;
    padding: 10px;
    cursor: pointer;
   transition: background-color 0.3s ease;  Renk geÃ§iÅŸi 
} 


	</style>
</head>
<body>
    <h1>IPTV Player</h1>
         
		 
		<div id="m3u-boxes">
    <div class="box" id="box1" onclick="updateM3U('https://dl.dropbox.com/scl/fi/r4p9v7g76ikwt8zsyuhyn/sile.m3u?rlkey=esnalbpm4kblxgkvym51gjokm', 'box1')">  <span>silinebilir</span></div>
    <div class="box" id="box2" onclick="updateM3U('https://yolla.link/DRAG10', 'box2')"><span>DRAG10</span></div>
    <div class="box" id="box3" onclick="updateM3U('https://cors-anywhere.yidianzhishi.cn/https://koprulu2.global.ssl.fastly.net/app7/rectv.m3u', 'box3')"><span>rec tv</span></div>
    <div class="box" id="box4" onclick="updateM3U('https://dl.dropbox.com/scl/fi/getue3cktknyt34rqebuu/MoOnCrOwN35dizi.m3u?rlkey=sl5r2zcudctxa5691h9g5iilc', 'box4')"><span>mooncrown</span></div>
    <div class="box" id="box5" onclick="updateM3U('https://dl.dropbox.com/s/vfvbyfu7u85xpbx/tr1.m3u', 'box5')"><span>drp-tr1</span></div>
    <div class="box" id="box6" onclick="updateM3U('https://dl.dropbox.com/scl/fi/wb47wl9ktgqzrc9t1vj71/Converted.m3u?rlkey=92kk48c0er3g303eeicgfy7nr', 'box6')"><span>Converted</span></div>
    <div class="box" id="box7" onclick="updateM3U('https://dl.dropbox.com/scl/fi/umektfpaw0y2oghva0q2k/belgesel.m3u?rlkey=a1wxv6xxb2191qh97jmhg9e2q', 'box7')"><span>drp-belgesel</span></div>
    <div class="box" id="box8" onclick="updateM3U('https://tinyurl.com/42e7ftm5', 'box8')"><span>korhan</span></div>
    <div class="box" id="box9" onclick="updateM3U('https://tinyurl.com/24lt9aqs', 'box9')"><span>power-dizi-orginal</span></div>
    <div class="box" id="box10" onclick="updateM3U('https://tinyurl.com/2ao2rans', 'box10')"><span>power-sinema-orginal</span></div>
</div> 
	<!-- ğŸ“Œ Tek bir hata mesajÄ± kutusu -->
<div id="error-box">
    <img src="" alt="Hata" id="error-image">
    <p id="error-message"></p>
</div>
  <p id="status-message" class="error-message"></p>



		 <button onclick="clearLocalStorage()">ğŸ—‘ï¸ TÃ¼m Verileri Sil</button>
<button onclick="downloadLocalStorage()">ğŸ“‚ LocalStorage Verilerini Ä°ndir</button>

	<button onclick="showLocalStorage()">ğŸ“‚ LocalStorage Verilerini GÃ¶ster</button>
<div id="storageData" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>

  <!-- ğŸ“Œ 1ï¸âƒ£ Arama Kutusu -->
	<input type="text" id="filter" placeholder="ğŸ” Kanal adÄ± veya kategori ara..." oninput="filterChannels()"> <!-- ğŸ“Œ KullanÄ±cÄ± kanal ismi veya kategori arayabilir -->
  
   <div id="search-results" style="margin-top: 10px; padding: 10px; border: 1px solid #ccc;"></div>

<!-- ğŸ“Œ 2ï¸âƒ£ Video OynatÄ±cÄ± -->
      <div id="player-container">
    <video id="my-video" class="video-js my-video-player" controls preload="auto" data-setup="{}"> </video>
    <div id="player-logo-container">
        <img id="player-logo" src="" alt="Kanal Logosu">
    </div>
    <div id="player-title-container">
        <span id="player-title"></span>
    </div>
</div>



  <!-- ğŸ“Œ 3ï¸âƒ£ Favori Kanallar -->
    <h2 onclick="toggleFavorites()">â­ Favori Kanallar (<span id="fav-count">0</span>)</h2>
    <div id="favorites" class="favorite-container"></div><!-- ğŸ“Œ Favori kanallar bÃ¶lÃ¼mÃ¼ -->
<!-- ğŸ“Œ 4ï¸âƒ£ Son Ä°zlenenler -->
    <h2 onclick="toggleRecent()">ğŸ“º Son Ä°zlenenler (<span id="recent-count">0</span>)</h2>
    <div id="recent" class="recent-container"></div> <!-- ğŸ“Œ Son izlenenler bÃ¶lÃ¼mÃ¼ -->

<h2 onclick="toggleAllChannels()">ğŸ“º TÃ¼m Kanallar (<span id="total-count">0</span>)</h2>
<div id="all-channels" class="category-container" style="display: none;"></div> <!-- ğŸ“Œ TÃ¼m kanallarÄ± gizli baÅŸlatÄ±yoruz -->

  <div id="categories"></div> <!-- ğŸ“Œ KanallarÄ±n kategorilere gÃ¶re listeleneceÄŸi bÃ¶lÃ¼m -->
  <link href="https://vjs.zencdn.net/7.17.0/video-js.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest/dist/hls.min.js"></script>
 <script src="https://vjs.zencdn.net/7.17.0/video.js"></script>
 


    <script>
 





function updateM3U(url, boxId) {
    // Hata mesajÄ±nÄ± temizle
    document.getElementById("status-message").innerText = "";

    if (!url || url.trim() === "") {
        document.getElementById("status-message").innerText = "Hata: URL ayrÄ±ÅŸtÄ±rÄ±lamadÄ±!";
        return;
    }

    // Ã–nce tÃ¼m kutularÄ±n rengini sÄ±fÄ±rla
    const allBoxes = document.querySelectorAll(".box");
    allBoxes.forEach(box => box.classList.remove("active-box"));

    // SeÃ§ilen kutunun rengini deÄŸiÅŸtir
    const selectedBox = document.getElementById(boxId);
    if (selectedBox) selectedBox.classList.add("active-box");

    // Ã–nceki yayÄ±nÄ± sonlandÄ±r
    let videoElement = document.getElementById("my-video");
    videoElement.pause(); // YayÄ±nÄ± durdur
    videoElement.src = ""; // URL'yi sÄ±fÄ±rla
    videoElement.load(); // TarayÄ±cÄ±da gÃ¼ncelle

    // Yeni yayÄ±nÄ± baÅŸlat
    videoElement.src = url;
    videoElement.play();

    console.log("SeÃ§ilen URL:", url);
    document.getElementById("status-message").innerText = "BaÅŸarÄ±lÄ±: YayÄ±n baÅŸlatÄ±ldÄ±!";
}






  document.querySelectorAll(".box").forEach(box => {
        box.addEventListener("click", function() {
            // Ã–nce tÃ¼m kutularÄ±n rengini sÄ±fÄ±rla
            document.querySelectorAll(".box").forEach(b => b.classList.remove("active-box"));

            // SeÃ§ilen kutuya aktif sÄ±nÄ±f ekle
            this.classList.add("active-box");

            console.log("SeÃ§ilen Kutu:", this.id);
        });
    });






 //let m3uUrl = "https://yolla.link/DRAG10";
  function updateM3U(url) {
    m3uUrl = url; // ğŸ“Œ Yeni URL'yi ata
    fetchM3U();  // ğŸ“Œ Mevcut ayrÄ±ÅŸtÄ±rma fonksiyonunu Ã§alÄ±ÅŸtÄ±r
}

  
  function openM3U(url) {
            window.open(url, '_blank'); // Yeni sekmede M3U dosyasÄ±nÄ± aÃ§
        }
// const m3uUrl =url;
	// const m3uUrl = "https://dl.dropbox.com/scl/fi/r4p9v7g76ikwt8zsyuhyn/sile.m3u?rlkey=esnalbpm4kblxgkvym51gjokm"; 
           let favoriteChannels = JSON.parse(localStorage.getItem("favorites")) ||document.getElementById(localStorage.getItem("all-channels"))|| []; // ğŸ“Œ Favori kanallar tarayÄ±cÄ±daki localStorage'dan alÄ±nÄ±yor
        let recentChannels = JSON.parse(localStorage.getItem("recent")) || []; // ğŸ“Œ Son izlenen kanallar da localStorage'dan alÄ±nÄ±yor
    
 
   
  if (!Array.isArray(favoriteChannels)) {
            favoriteChannels = [];
        }

	
async function fetchM3U() {
    const errorMessageDiv = document.getElementById("error-message");
    errorMessageDiv.style.display = "none"; // ğŸ“Œ BaÅŸlangÄ±Ã§ta hata mesajÄ±nÄ± gizle
    
    try {
        const response = await fetch(m3uUrl);
        if (!response.ok) throw new Error(`BaÄŸlantÄ± baÅŸarÄ±sÄ±z: ${response.status}`);
        
        const content = await response.text(); // ğŸ“Œ M3U dosyasÄ±nÄ± metin olarak alÄ±yoruz
        processM3U(content);
    } catch (error) {
        showError(error.message);
    }
}	
		
function checkImage(url, callback) {
    let img = new Image();
    img.src = url;
    img.onload = () => callback(url); // GÃ¶rsel yÃ¼klenirse, aynÄ± URL kullan
    img.onerror = () => callback("https://static4.depositphotos.com/1006994/298/v/950/depositphotos_2983099-stock-illustration-grunge-design.jpg"); // Hata varsa alternatif kullan
}

 function processM3U(content) {
            const lines = content.split("\n").map(line => line.trim()).filter(line => line);
            let categories = {}; // ğŸ“Œ Kategorileri saklamak iÃ§in nesne
            let totalChannels = 0;

            for (let i = 0; i < lines.length; i++) {
                if (lines[i].startsWith("#EXTINF")) { // ğŸ“Œ Kanal bilgileri iÃ§eren satÄ±rlarÄ± kontrol et
                    let infoParts = lines[i].split(",");
                     let attributes = infoParts[0].match(/group-title="([^"]+)"/); // ğŸ“Œ Kategori bilgisi alÄ±nÄ±yor
                    let logoMatch = infoParts[0].match(/tvg-logo="([^"]+)"/); // ğŸ“Œ Kanal logosu bilgisi alÄ±nÄ±yor
                    let category = attributes ? attributes[1] : "DiÄŸer";
                    let title = infoParts[1] ? infoParts[1] : "Bilinmeyen Kanal"; 
                    let url = lines[i + 1];  // ğŸ“Œ Kanal URL'si alÄ±nÄ±yor
                  	let logo = logoMatch ? logoMatch[1] : "https://static4.depositphotos.com/1006994/298/v/950/depositphotos_2983099-stock-illustration-grunge-design.jpg";
 // Kanal logolarÄ±nÄ± kontrol edip deÄŸiÅŸtirecek kod
 checkImage(logo, function(updatedURL) {
                        container.innerHTML += `
                            <div class="channel">
                                <img src="${updatedURL}" alt="${title}">
                                <h3>${title}</h3>
                                <p>${url}</p>
                            </div>
                        `;
                    });
                    if (!categories[category]) {
                        categories[category] = [];
                    }

             categories[category].push({ title, url, logo, category });
                    totalChannels++;
                }
            }

            document.getElementById("total-count").innerText = totalChannels; // ğŸ“Œ Toplam kanal sayÄ±sÄ±nÄ± gÃ¼ncelle
            displayChannels(categories); // ğŸ“Œ KanallarÄ± ekrana yerleÅŸtir
            displayFavorites(); // ğŸ“Œ Favori kanallarÄ± gÃ¶ster
            displayRecent(); // ğŸ“Œ Son izlenenleri gÃ¶ster
            displayAllChannels(categories);
	        
	  }
		
		function displayChannels(categories) {
            const container = document.getElementById("categories");  // Kategorileri gÃ¶stereceÄŸimiz ana konteyneri seÃ§iyoruz
            container.innerHTML = ""; // Ã–nceki iÃ§erikleri temizliyoruz

            Object.keys(categories).forEach(category => {  // TÃ¼m kategorileri dÃ¶ngÃ¼ye sokarak ekrana ekliyoruz
                 const channelCount = categories[category].length;  // O kategorideki kanal sayÄ±sÄ±nÄ± alÄ±yoruz
				 // Kategori baÅŸlÄ±ÄŸÄ±nÄ± oluÅŸturuyoruz ve tÄ±klanÄ±nca aÃ§Ä±lÄ±p kapanmasÄ±nÄ± saÄŸlÄ±yoruz
				container.innerHTML += `<h2 onclick="toggleCategory('${category}')">${category} KanallarÄ±(${channelCount})</h2>
                <div id="${category}" class="category-container"></div>`;
 // Kategoriye ait bÃ¶lÃ¼mÃ¼ seÃ§iyoruz
                const categoryContainer = document.getElementById(category); 
                categories[category].forEach(channel => {   // Kategori iÃ§indeki tÃ¼m kanallarÄ± dÃ¶ngÃ¼ye sokarak ekliyoruz
                    const isFavorite = favoriteChannels.some(fav => fav.title === channel.title);  // KanalÄ±n favorilerde olup olmadÄ±ÄŸÄ±nÄ± kontrol ediyoruz
// KanalÄ±n iÃ§eriÄŸini oluÅŸturuyoruz
                    categoryContainer.innerHTML += `
                        <div class="channel">
                            <img src="${channel.logo}" alt="${channel.title}" onclick="playStream('${channel.title}', '${channel.url}', '${channel.logo}')">
                            <h3>${channel.title}</h3>
                            <button class="fav-btn" data-title="${channel.title}" onclick="toggleFavorite('${channel.title}', '${channel.url}', '${channel.logo}', '${category}', this)">
                                ${isFavorite ? "â˜… Favorilerden Ã‡Ä±kar" : "â˜† Favorilere Ekle"}
                            </button>
                        </div>
                    `;
                });
            });
        }
		   /* ğŸ“Œ 3ï¸âƒ£ Favori KanallarÄ± GÃ¶sterme */

		function displayFavorites() {
    // Favori kanallarÄ±n gÃ¶sterileceÄŸi konteyneri seÃ§iyoruz
    const container = document.getElementById("favorites");
    container.innerHTML = ""; // Ã–nceki iÃ§eriÄŸi temizliyoruz




   // EÄŸer favori kanal yoksa, kullanÄ±cÄ±ya bilgilendirici bir mesaj gÃ¶steriyoruz
            if (favoriteChannels.length === 0) {
                container.innerHTML = "<p>Favori kanalÄ±nÄ±z yok.</p>";
            } else {
                // Favori kanallarÄ±n listesini dÃ¶ngÃ¼ye sokarak ekrana ekliyoruz
			   favoriteChannels.forEach(channel => {
           
            const isFavorite = favoriteChannels.some(fav => fav.title === channel.title);
            container.innerHTML += `
                <div class="channel">
                    <img src="${channel.logo}" alt="${channel.title}" onclick="playStream('${channel.title}', '${channel.url}', '${channel.logo}')">
                    <h3>${channel.title}</h3>
                    <button class="fav-btn" data-title="${channel.title}" onclick="toggleFavorite('${channel.title}', '${channel.url}', '${channel.logo}', '${channel.category}', this)">
                        ${isFavorite ? "â˜… Favorilerden Ã‡Ä±kar" : "â˜† Favorilere Ekle"}
                    </button>
                </div>
            `;
        });
    }
 // Favori kanal sayÄ±sÄ±nÄ± gÃ¼ncelliyoruz
    document.getElementById("fav-count").innerText = favoriteChannels.length;
}

 // Belirtilen kategorinin gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼nÃ¼ deÄŸiÅŸtirir
function toggleCategory(category) {
    const container = document.getElementById(category);
    // EÄŸer kategori gÃ¶rÃ¼nmÃ¼yorsa (display: none), gÃ¶ster; aksi halde gizle
    container.style.display = container.style.display === "none" ? "block" : "none";
}


/*
// Favori kanallar bÃ¶lÃ¼mÃ¼nÃ¼n gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼nÃ¼ deÄŸiÅŸtirir
function toggleFavorites() {
    const container = document.getElementById("favorites");
    container.style.display = container.style.display === "none" ? "block" : "none";
}
*/


 /* ğŸ“Œ 5ï¸âƒ£ Favori Kanallar BÃ¶lÃ¼mÃ¼nÃ¼ AÃ§/Kapat */
function toggleFavorites() {
    const favoritesContainer = document.getElementById("favorites");
    const favoritesHeader = document.querySelector("#favorites").previousElementSibling; // BaÅŸlÄ±ÄŸÄ± seÃ§
    const currentColor = favoritesHeader.style.backgroundColor; // Mevcut rengi al

    if (favoritesContainer.style.display === "none" || favoritesContainer.style.display === "") {
        favoritesContainer.style.display = "block";
        favoritesHeader.style.backgroundColor = currentColor === "darkblue" ? "#333" : "pink"; // Rengi deÄŸiÅŸtir
    } else {
        favoritesContainer.style.display = "none";
        favoritesHeader.style.backgroundColor = currentColor === "darkblue" ? "#333" : "red"; // Rengi deÄŸiÅŸtir
    }
}





 /* ğŸ“Œ 6ï¸âƒ£ Son Ä°zlenenleri YÃ¶net */
// Son izlenenler bÃ¶lÃ¼mÃ¼nÃ¼n gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼nÃ¼ deÄŸiÅŸtirir

function toggleRecent() {
    const container = document.getElementById("recent");
    const recentHeader = document.querySelector("#recent").previousElementSibling; // BaÅŸlÄ±ÄŸÄ± seÃ§
    const currentColor = recentHeader.style.backgroundColor; // Mevcut rengi al

    if (container.style.display === "none" || container.style.display === "") {
        container.style.display = "block";
        recentHeader.style.backgroundColor = currentColor === "darkblue" ? "#333" : "pink"; // Rengi deÄŸiÅŸtir
    } else {
        container.style.display = "none";
        recentHeader.style.backgroundColor = currentColor === "darkblue" ? "#333" : "red"; // Rengi deÄŸiÅŸtir
    }
}

/*
function toggleRecent() {
    const container = document.getElementById("recent");
    container.style.display = container.style.display === "none" ? "block" : "none";
}
*/

	 /* ğŸ“Œ 7ï¸âƒ£ KanalÄ± Favorilere Ekle veya Ã‡Ä±kar */	
// KanalÄ± favorilere ekler veya favorilerden Ã§Ä±karÄ±r
        function toggleFavorite(title, url, logo, category, button) {
            const index = favoriteChannels.findIndex(channel => channel.title === title);// Mevcut favori kanal listesinde kanalÄ±n olup olmadÄ±ÄŸÄ±nÄ± kontrol eder
            if (index >= 0) {
                favoriteChannels.splice(index, 1);  // EÄŸer kanal favorilerde varsa, listeden kaldÄ±r
            } else {
			 // EÄŸer kanal favorilerde yoksa, ekle
                favoriteChannels.push({ title, url, logo, category });
            }

            localStorage.setItem("favorites", JSON.stringify(favoriteChannels));
            displayFavorites();// Buton iÃ§eriÄŸini zorla gÃ¼ncelle Favorilerden Ã‡Ä±kar" : "â˜† Favorilere Ekle bursÄ± yapÄ±yor
            filterChannels() // Buton iÃ§eriÄŸini zorla gÃ¼ncelle Favorilerden Ã‡Ä±kar" : "â˜† Favorilere Ekle
    // Buton iÃ§eriÄŸini zorla gÃ¼ncelle
    setTimeout(() => {
        button.innerText = favoriteChannels.some(channel => channel.title === title) ? "â˜… Favorilerden Ã‡Ä±kar" : "â˜† Favorilere Ekle";
    }, 100);
}


/* ğŸ“Œ 4ï¸âƒ£ Son Ä°zlenen KanallarÄ± GÃ¶sterme */
function displayRecent() {
     // Son izlenen kanallarÄ± gÃ¶stereceÄŸimiz konteyneri seÃ§iyoruz
	const container = document.getElementById("recent");
    container.innerHTML = ""; // Ã–nceki iÃ§eriÄŸi temizleyerek yeni veriler eklemeye hazÄ±r hale getiriyoruz
   // EÄŸer son izlenen kanal yoksa, kullanÄ±cÄ±ya bilgilendirici bir mesaj gÃ¶steriyoruz
    if (recentChannels.length === 0) {
                container.innerHTML = "<p>HenÃ¼z izlenen bir kanal yok</p>";
            } else {
			// Son izlenen kanallarÄ± dÃ¶ngÃ¼ye sokarak ekrana ekliyoruz
                recentChannels.forEach(channel => {
                    container.innerHTML += `
                        <div class="channel">
						 <!-- Kanal logosu, tÄ±klanÄ±nca yayÄ±nÄ± baÅŸlatÄ±yor -->
                            <img src="${channel.logo}" alt="${channel.title}" onclick="playStream('${channel.title}', '${channel.url}', '${channel.logo}')">
                               <!-- Kanal adÄ± -->
                    <h3>${channel.title}</h3>
                    <!-- KanalÄ± son izlenenlerden silme butonu -->
                          <button class="fav-btn" onclick="removeRecent('${channel.title}', '${channel.url}', '${channel.logo}')">ğŸ—‘ï¸ Sil</button>
						</div>
                    `;
                });
            }
  // Son izlenen kanal sayÄ±sÄ±nÄ± gÃ¼ncelliyoruz
    document.getElementById("recent-count").innerText = recentChannels.length;
}


function removeRecent(title, url, logo, category, button) {
   const index = recentChannels.findIndex(channel => channel.url === url);
            if (index >= 0) {
   recentChannels.splice(index, 1); // ğŸ“Œ SeÃ§ilen Ã¶ÄŸeyi listeden Ã§Ä±kar
      } else {
                recentChannels.push({ title, url, logo, category });
            }
	
	localStorage.setItem("recent", JSON.stringify(recentChannels)); // GÃ¼ncellenmiÅŸ listeyi kaydet
    displayRecent(); // Listeyi yeniden yÃ¼kle
    // DÃ¼ÄŸmeyi anÄ±nda gÃ¼ncelle
            button.innerText = recentChannels.some(channel => channel.title === title) ? "â˜… Favorilerden Ã‡Ä±kar" : "â˜† Favorilere Ekle";

}

let player = videojs('my-video');
/* ğŸ“Œ 2ï¸âƒ£ YayÄ±n BaÅŸlatma */
function playStream(title, url, logo, category) {
    const playerContainer = document.getElementById("player-container");
    const playerLogo = document.getElementById("player-logo");
    const playerTitle = document.getElementById("player-title");
    const errorMessageDiv = document.getElementById("error-message");

    playerContainer.style.display = "block";
    playerLogo.src = logo;
    playerTitle.textContent = title 
    // Ã–nceki kaynaklarÄ± temizle
    player.src([]);
    player.off('error'); // Ã–nceki hata dinleyicilerini kaldÄ±r

    // Hata durumunda gÃ¶sterilecek genel mesaj
    const genelHataMesaji = "Bu baÄŸlantÄ± oynatÄ±lamÄ±yor. LÃ¼tfen baÅŸka bir kanal deneyin.";

    // URL'den dosya tÃ¼rÃ¼nÃ¼ ve MIME tÃ¼rÃ¼nÃ¼ belirle
    let fileType = url.split('.').pop().toLowerCase();
    let mimeType = '';

    switch (fileType) {
        case 'm3u8':
            mimeType = 'application/x-mpegURL';
            break;
        case 'mp4':
            mimeType = 'video/mp4';
            break;
        case 'webm':
            mimeType = 'video/webm';
            break;
        case 'ogg':
            mimeType = 'video/ogg';
            break;
        // DiÄŸer formatlarÄ± buraya ekleyebilirsiniz
        default:
            mimeType = 'video/mp4'; // VarsayÄ±lan olarak MP4
            console.warn("Bilinmeyen dosya tÃ¼rÃ¼: ", fileType);
    }

    // HLS desteÄŸi kontrolÃ¼
    if (fileType === 'm3u8') {
        if (hls.supportsMediaSource()) {
            if (hls.instances.length > 0) {
                hls.instances.forEach(h => h.destroy());
            }
            hls.loadSource(url);
            hls.attachMedia(player.el());
            hls.on(Hls.Events.MANIFEST_PARSED, function() {
                player.play();
            });
            hls.on(Hls.Events.ERROR, function(event, data) {
                console.error("HLS oynatma hatasÄ±:", data);
                showError(genelHataMesaji, errorMessageDiv);
            });
        } else if (player.canPlayType('application/vnd.apple.mpegurl')) {
            player.src({ src: url, type: mimeType });
            player.play();
        } else {
            showError("Bu tarayÄ±cÄ±da HLS desteklenmiyor.", errorMessageDiv);
            return;
        }
    } else {
        // DiÄŸer formatlar iÃ§in basit oynatma
        player.src({ src: url, type: mimeType });
        player.play();
        player.on('error', function() {
        showError(genelHataMesaji, errorMessageDiv);});
   }
            
            if (!recentChannels.some(channel => channel.url === url)) {
                recentChannels.unshift({
                    title,
                    url,
                    logo,
                    category
                });
                // ğŸ“Œ Son izlenenler listesine ekleme
                if (recentChannels.length > 50) recentChannels.pop();
                // ğŸ“Œ En fazla 50 kanal tutulacak
                localStorage.setItem("recent", JSON.stringify(recentChannels));              
		   }
 
        displayRecent();    
}

		    document.addEventListener("fullscreenchange", () => {
            const playerContainer = document.getElementById("player-container");           
            if (!document.fullscreenElement) {playerContainer.style.display = "none";  }   // ğŸ“Œ Tam ekrandan Ã§Ä±kÄ±nca oynatÄ±cÄ± kapanacak
        });



function showError(message, element) {
    element.textContent = message;
    element.style.display = "block";
    setTimeout(function() {
        element.style.display = "none";
        element.textContent = "";
    }, 500);
}

        fetchM3U(); // ğŸ“Œ M3U dosyasÄ±nÄ± getir ve iÅŸle
		
	function clearLocalStorage() {
    localStorage.removeItem("favorites"); // Favori kanallarÄ± sil
    localStorage.removeItem("recent");    // Son izlenenleri sil
    
    // EkranÄ± gÃ¼ncelle
    displayFavorites();
    displayRecent();
    
    alert("TÃ¼m kayÄ±tlar baÅŸarÄ±yla temizlendi!");
}

function showLocalStorage() {
    const favorites = localStorage.getItem("favorites") || "Favori kanal kaydÄ± yok.";
    const recent = localStorage.getItem("recent") || "Son izlenen kanal kaydÄ± yok.";

    const textContent = `<h3>Favori Kanallar:</h3><pre>${favorites}</pre>
                         <h3>Son Ä°zlenenler:</h3><pre>${recent}</pre>`;

    document.getElementById("storageData").innerHTML = textContent;
}


function downloadLocalStorage() {
    const favorites = localStorage.getItem("favorites") || "Favori kanal kaydÄ± yok.";
    const recent = localStorage.getItem("recent") || "Son izlenen kanal kaydÄ± yok.";

    const textContent = `Favori Kanallar:\n${favorites}\n\nSon Ä°zlenenler:\n${recent}`;
    
    const blob = new Blob([textContent], { type: "text/plain" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "iptv_localstorage.txt";
    
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}


function displayAllChannels(categories) {
    const container = document.getElementById("all-channels");
    container.innerHTML = ""; // ğŸ“Œ Ã–nceki iÃ§eriÄŸi temizle

    let allChannels = []; // ğŸ“Œ TÃ¼m kanallarÄ± saklayacaÄŸÄ±mÄ±z dizi

    // ğŸ“Œ Mevcut kategorileri kaldÄ±rarak tÃ¼m kanallarÄ± tek bir dizide birleÅŸtiriyoruz
    Object.values(categories).forEach(categoryChannels => {
        allChannels = allChannels.concat(categoryChannels);
    });

    allChannels.forEach(channel => {
        const isFavorite = favoriteChannels.some(fav => fav.title === channel.title);
        container.innerHTML += `
            <div class="channel">
                <img src="${channel.logo}" alt="${channel.title}" onclick="playStream('${channel.title}', '${channel.url}', '${channel.logo}')">
                <h3>${channel.title}</h3>
                <button class="fav-btn" data-title="${channel.title}" onclick="toggleFavorite('${channel.title}', '${channel.url}', '${channel.logo}', '${channel.category}', this)">
                    ${isFavorite ? "â˜… Favorilerden Ã‡Ä±kar" : "â˜† Favorilere Ekle"}
                </button>
            </div>
        `;
    });

    document.getElementById("total-count").innerText = allChannels.length;
}




function toggleAllChannels() {
    const container = document.getElementById("all-channels");
    container.style.display = container.style.display === "none" ? "block" : "none";
}

// ğŸ“Œ Toggle (AÃ§/Kapat) Ã¶zelliÄŸini ekleyelim
function toggleAllChannels() {
    const container = document.getElementById("all-channels");
    const AllChannelsHeader = document.querySelector("#all-channels").previousElementSibling; // BaÅŸlÄ±ÄŸÄ± seÃ§
    const currentColor = AllChannelsHeader.style.backgroundColor; // Mevcut rengi al

    if (container.style.display === "none" || container.style.display === "") {
        container.style.display = "block";
        AllChannelsHeader.style.backgroundColor = currentColor === "darkblue" ? "#333" : "pink"; // Rengi deÄŸiÅŸtir
    } else {
        container.style.display = "none";
        AllChannelsHeader.style.backgroundColor = currentColor === "darkblue" ? "#333" : "red"; // Rengi deÄŸiÅŸtir
    }
}



//box mesajÄ±
function showError(message) {
    const errorBox = document.getElementById("error-box");
    const errorMessage = document.getElementById("error-message");

    errorMessage.textContent = message;
    errorBox.style.display = "block";

    setTimeout(() => {
        errorBox.style.display = "none";
        errorMessage.textContent = "";
    }, 5000); // ğŸ“Œ 5 saniye sonra hata kutusu kaybolur
}


 /* ğŸ“Œ 1ï¸âƒ£ Arama Ä°ÅŸlevi */

function filterChannels() {
    let searchText = document.getElementById("filter").value.toLowerCase();
    let searchResultsContainer = document.getElementById("search-results");
    
    // ğŸ“Œ EÄŸer arama kutusu boÅŸsa, listeyi gizle ve fonksiyonu sonlandÄ±r
    if (searchText.trim() === "") {
        searchResultsContainer.style.display = "none";
        return;
    }

    searchResultsContainer.innerHTML = ""; // ğŸ“Œ Ã–nceki sonuÃ§larÄ± temizle
    let uniqueTitles = new Set();
    let allChannels = document.querySelectorAll(".channel");

    allChannels.forEach(channel => {
        let titleElement = channel.querySelector("h3");
        let urlElement = channel.querySelector("p");

        if (!titleElement || !urlElement) return;

        let title = titleElement.textContent.trim().toLowerCase();
        let url = urlElement.textContent.trim();

        if (title.includes(searchText) && !uniqueTitles.has(title)) {
            uniqueTitles.add(title);
            searchResultsContainer.innerHTML += `
                <div class="channel">
                    <img src="${channel.querySelector("img").src}" alt="${title}" onclick="playStream('${title}', '${url}', '${channel.querySelector("img").src}')">
                    <h3>${title}</h3>
                    <button class="fav-btn" data-title="${title}" onclick="toggleFavorite('${title}', '${url}', '${channel.querySelector("img").src}', this)">
                        ${favoriteChannels.some(fav => fav.title === title) ? "â˜… Favorilerden Ã‡Ä±kar" : "â˜† Favorilere Ekle"}
                    </button>  
                </div>
            `;
        }
    });

    // ğŸ“Œ EÄŸer sonuÃ§ bulunursa, listeyi gÃ¶ster; aksi halde gizle
    searchResultsContainer.style.display = uniqueTitles.size > 0 ? "block" : "none";
}


document.getElementById("filter").addEventListener("keypress", function(event) {
    if (event.key === "Enter") {
        filterChannels(); // Enter'a basÄ±nca arama fonksiyonunu Ã§alÄ±ÅŸtÄ±r
    }
});

document.getElementById("filter").addEventListener("input", function() {
    console.log("Arama kutusu Ã§alÄ±ÅŸÄ±yor!");
});

document.querySelectorAll(".channel").forEach(channel => {
    console.log("Kanal iÃ§eriÄŸi:", channel.textContent.toLowerCase());
});
const container = document.getElementById("all-channels");
console.log("Kanal listesi gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼:", container.style.display);

console.log(document.querySelectorAll(".channel"));


	
    </script>
</body>
</html>























		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		



















